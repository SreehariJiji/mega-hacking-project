# Exercise 2 — Kerberoasting Lab Notes

This folder documents the **Kerberoasting – Service Account Credential Recovery lab** used for the Kerberoasting exercise.

---

## Quick Facts

- **Domain (FQDN):** `lab.local`  
- **NetBIOS:** `LAB`  
- **Domain Controller OS:** Windows Server 2012 R2 Standard Evaluation  
- **Attacker VM:** Kali Linux  
- **Standard User:** `LAB\User1`  
- **Service Account:** `LAB\svcweb`  
- **SPN:** `HTTP/webapp.lab.local`  
- **Isolated Subnet:** `192.168.45.0/24`  
  - **DC IP used:** `192.168.45.157`  
  - **Kali IP used:** `192.168.45.133`

---

## Tools Used

### Setup (Windows)
- Server Manager (AD DS + DNS)
- Active Directory Users and Computers
- `setspn`

### Attack + Validation (Kali)
- Impacket
- John the Ripper
- smbclient

---

## VM Specs (Recommended)

### Domain Controller
- 2 vCPU  
- 2–4 GB RAM  
- ~40 GB disk  
- 1 NIC on isolated VMware network

### Kali
- 2 vCPU  
- 2–4 GB RAM  
- ~30–40 GB disk  
- 1 NIC on the same isolated network

---

## Lab Setup

### 1) Build the Domain Controller
1. Install Windows Server 2012 R2.
2. Add roles:
   - **Active Directory Domain Services**
   - **DNS Server**
3. Promote to a new forest:
   - **Domain:** `lab.local`
4. Reboot.

---

### 2) Create OU and Accounts
In **Active Directory Users and Computers**:

1. Create an OU:
   - `LAB USERS`
2. Create:
   - Standard user: `User1`
   - Service account: `svcweb`

---

### 3) Assign the SPN
On the Domain Controller:

- Assign SPN to the service account:
  - `HTTP/webapp.lab.local` → `LAB\svcweb`

- Verify:
  - `setspn` output should list:
    - `HTTP/webapp.lab.local`

---

## Setup Evidence (This Repo)

Stored under:
`exercise-2-kerberoasting/lab-setup/`

1. `1 - DC VM specs.png`  
2. `2 - Domain created.png`  
3. `3 - Users created.png`  
4. `4 - SPN proof.png`

---

## Attack Steps (Lab)

1. Confirm Kali can reach the Domain Controller on the lab subnet.
2. Use **Impacket** to:
   - enumerate SPN-associated accounts  
   - request a service ticket for `HTTP/webapp.lab.local`  
   - export the TGS hash for `LAB\svcweb`
3. Use **John the Ripper** to crack the exported hash (baseline password).
4. Use **smbclient** to confirm authentication with the recovered `svcweb` credentials.

---

